<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.97">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chanseok Kang – eda_springleaf_screencast</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Chanseok Kang</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../publication.html" rel="" target="">
 <span class="menu-text">Publication</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../kr" rel="" target="">
 <span class="menu-text">Kr</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/goodboychan" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/chanseokk/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#read-the-data" id="toc-read-the-data" class="nav-link active" data-scroll-target="#read-the-data">Read the data</a></li>
  <li><a href="#data-overview" id="toc-data-overview" class="nav-link" data-scroll-target="#data-overview">Data overview</a></li>
  <li><a href="#dataset-cleaning" id="toc-dataset-cleaning" class="nav-link" data-scroll-target="#dataset-cleaning">Dataset cleaning</a>
  <ul class="collapse">
  <li><a href="#remove-constant-features" id="toc-remove-constant-features" class="nav-link" data-scroll-target="#remove-constant-features">Remove constant features</a></li>
  <li><a href="#remove-duplicated-features" id="toc-remove-duplicated-features" class="nav-link" data-scroll-target="#remove-duplicated-features">Remove duplicated features</a></li>
  </ul></li>
  <li><a href="#determine-types" id="toc-determine-types" class="nav-link" data-scroll-target="#determine-types">Determine types</a></li>
  <li><a href="#go-through" id="toc-go-through" class="nav-link" data-scroll-target="#go-through">Go through</a>
  <ul class="collapse">
  <li><a href="#var_0002-var_0003" id="toc-var_0002-var_0003" class="nav-link" data-scroll-target="#var_0002-var_0003">VAR_0002, VAR_0003</a></li>
  <li><a href="#var_0004" id="toc-var_0004" class="nav-link" data-scroll-target="#var_0004">VAR_0004</a></li>
  </ul></li>
  <li><a href="#categorical-features" id="toc-categorical-features" class="nav-link" data-scroll-target="#categorical-features">Categorical features</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">



<p>This is a notebook, used in the screencast video. Note, that the data files are not present here in Jupyter hub and you will not be able to run it. But you can always download the notebook to your local machine as well as the competition data and make it interactive. Competition data can be found here: https://www.kaggle.com/c/springleaf-marketing-response/data</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm_notebook</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> autolabel(arrayA):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">''' label each colored square with the corresponding data value. </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">    If value &gt; 20, the text is in black, else in white.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    arrayA <span class="op">=</span> np.array(arrayA)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(arrayA.shape[<span class="dv">0</span>]):</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(arrayA.shape[<span class="dv">1</span>]):</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                plt.text(j,i, <span class="st">"</span><span class="sc">%.2f</span><span class="st">"</span><span class="op">%</span>arrayA[i,j], ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>,color<span class="op">=</span><span class="st">'w'</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hist_it(feat):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">4</span>))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    feat[Y<span class="op">==</span><span class="dv">0</span>].hist(bins<span class="op">=</span><span class="bu">range</span>(<span class="bu">int</span>(feat.<span class="bu">min</span>()),<span class="bu">int</span>(feat.<span class="bu">max</span>()<span class="op">+</span><span class="dv">2</span>)),normed<span class="op">=</span><span class="va">True</span>,alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    feat[Y<span class="op">==</span><span class="dv">1</span>].hist(bins<span class="op">=</span><span class="bu">range</span>(<span class="bu">int</span>(feat.<span class="bu">min</span>()),<span class="bu">int</span>(feat.<span class="bu">max</span>()<span class="op">+</span><span class="dv">2</span>)),normed<span class="op">=</span><span class="va">True</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    plt.ylim((<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gt_matrix(feats,sz<span class="op">=</span><span class="dv">16</span>):</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> []</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i,c1 <span class="kw">in</span> <span class="bu">enumerate</span>(feats):</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        b <span class="op">=</span> [] </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j,c2 <span class="kw">in</span> <span class="bu">enumerate</span>(feats):</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            mask <span class="op">=</span> (<span class="op">~</span>train[c1].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>train[c2].isnull())</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i<span class="op">&gt;=</span>j:</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>                b.append((train.loc[mask,c1].values<span class="op">&gt;=</span>train.loc[mask,c2].values).mean())</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                b.append((train.loc[mask,c1].values<span class="op">&gt;</span>train.loc[mask,c2].values).mean())</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        a.append(b)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize <span class="op">=</span> (sz,sz))</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    plt.imshow(a, interpolation <span class="op">=</span> <span class="st">'None'</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> plt.xticks(<span class="bu">range</span>(<span class="bu">len</span>(feats)),feats,rotation <span class="op">=</span> <span class="dv">90</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    _ <span class="op">=</span> plt.yticks(<span class="bu">range</span>(<span class="bu">len</span>(feats)),feats,rotation <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    autolabel(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hist_it1(feat):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">4</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    feat[Y<span class="op">==</span><span class="dv">0</span>].hist(bins<span class="op">=</span><span class="dv">100</span>,<span class="bu">range</span><span class="op">=</span>(feat.<span class="bu">min</span>(),feat.<span class="bu">max</span>()),normed<span class="op">=</span><span class="va">True</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    feat[Y<span class="op">==</span><span class="dv">1</span>].hist(bins<span class="op">=</span><span class="dv">100</span>,<span class="bu">range</span><span class="op">=</span>(feat.<span class="bu">min</span>(),feat.<span class="bu">max</span>()),normed<span class="op">=</span><span class="va">True</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    plt.ylim((<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="read-the-data" class="level1">
<h1>Read the data</h1>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">'train.csv.zip'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> train.target</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">'test.csv.zip'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>test_ID <span class="op">=</span> test.ID</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-overview" class="level1">
<h1>Data overview</h1>
<p>Probably the first thing you check is the shapes of the train and test matrices and look inside them.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'Train shape'</span>, train.shape</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'Test shape'</span>,  test.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Train shape (145231, 1934)
Test shape (145232, 1933)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>train.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>VAR_0001</th>
      <th>VAR_0002</th>
      <th>VAR_0003</th>
      <th>VAR_0004</th>
      <th>VAR_0005</th>
      <th>VAR_0006</th>
      <th>VAR_0007</th>
      <th>VAR_0008</th>
      <th>VAR_0009</th>
      <th>...</th>
      <th>VAR_1926</th>
      <th>VAR_1927</th>
      <th>VAR_1928</th>
      <th>VAR_1929</th>
      <th>VAR_1930</th>
      <th>VAR_1931</th>
      <th>VAR_1932</th>
      <th>VAR_1933</th>
      <th>VAR_1934</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>H</td>
      <td>224</td>
      <td>0</td>
      <td>4300</td>
      <td>C</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>98</td>
      <td>98</td>
      <td>998</td>
      <td>999999998</td>
      <td>998</td>
      <td>998</td>
      <td>9998</td>
      <td>9998</td>
      <td>IAPS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>H</td>
      <td>7</td>
      <td>53</td>
      <td>4448</td>
      <td>B</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>98</td>
      <td>98</td>
      <td>998</td>
      <td>999999998</td>
      <td>998</td>
      <td>998</td>
      <td>9998</td>
      <td>9998</td>
      <td>IAPS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>H</td>
      <td>116</td>
      <td>3</td>
      <td>3464</td>
      <td>C</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>98</td>
      <td>98</td>
      <td>998</td>
      <td>999999998</td>
      <td>998</td>
      <td>998</td>
      <td>9998</td>
      <td>9998</td>
      <td>IAPS</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>H</td>
      <td>240</td>
      <td>300</td>
      <td>3200</td>
      <td>C</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>98</td>
      <td>98</td>
      <td>998</td>
      <td>999999998</td>
      <td>998</td>
      <td>998</td>
      <td>9998</td>
      <td>9998</td>
      <td>RCC</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>R</td>
      <td>72</td>
      <td>261</td>
      <td>2000</td>
      <td>N</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>98</td>
      <td>98</td>
      <td>998</td>
      <td>999999998</td>
      <td>998</td>
      <td>998</td>
      <td>9998</td>
      <td>9998</td>
      <td>BRANCH</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1934 columns</p>
</div>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="11">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>test.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>VAR_0001</th>
      <th>VAR_0002</th>
      <th>VAR_0003</th>
      <th>VAR_0004</th>
      <th>VAR_0005</th>
      <th>VAR_0006</th>
      <th>VAR_0007</th>
      <th>VAR_0008</th>
      <th>VAR_0009</th>
      <th>...</th>
      <th>VAR_1925</th>
      <th>VAR_1926</th>
      <th>VAR_1927</th>
      <th>VAR_1928</th>
      <th>VAR_1929</th>
      <th>VAR_1930</th>
      <th>VAR_1931</th>
      <th>VAR_1932</th>
      <th>VAR_1933</th>
      <th>VAR_1934</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>R</td>
      <td>360</td>
      <td>25</td>
      <td>2251</td>
      <td>B</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>98</td>
      <td>98</td>
      <td>998</td>
      <td>999999998</td>
      <td>998</td>
      <td>998</td>
      <td>9998</td>
      <td>9998</td>
      <td>IAPS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>R</td>
      <td>74</td>
      <td>192</td>
      <td>3274</td>
      <td>C</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>98</td>
      <td>98</td>
      <td>998</td>
      <td>999999998</td>
      <td>998</td>
      <td>998</td>
      <td>9998</td>
      <td>9998</td>
      <td>IAPS</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>R</td>
      <td>21</td>
      <td>36</td>
      <td>3500</td>
      <td>C</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>98</td>
      <td>98</td>
      <td>998</td>
      <td>999999998</td>
      <td>998</td>
      <td>998</td>
      <td>9998</td>
      <td>9998</td>
      <td>IAPS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>R</td>
      <td>8</td>
      <td>2</td>
      <td>1500</td>
      <td>B</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>98</td>
      <td>98</td>
      <td>998</td>
      <td>999999998</td>
      <td>998</td>
      <td>998</td>
      <td>9998</td>
      <td>9998</td>
      <td>IAPS</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>H</td>
      <td>91</td>
      <td>39</td>
      <td>84500</td>
      <td>C</td>
      <td>8.0</td>
      <td>3.0</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>0</td>
      <td>98</td>
      <td>98</td>
      <td>998</td>
      <td>999999998</td>
      <td>998</td>
      <td>998</td>
      <td>9998</td>
      <td>9998</td>
      <td>IAPS</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1933 columns</p>
</div>
</div>
</div>
<p>There are almost 2000 anonymized variables! It’s clear, some of them are categorical, some look like numeric. Some numeric feateures are integer typed, so probably they are event conters or dates. And others are of float type, but from the first few rows they look like integer-typed too, since fractional part is zero, but pandas treats them as <code>float</code> since there are NaN values in that features.</p>
<p>From the first glance we see train has one more column <code>target</code> which we should not forget to drop before fitting a classifier. We also see <code>ID</code> column is shared between train and test, which sometimes can be succesfully used to improve the score.</p>
<p>It is also useful to know if there are any NaNs in the data. You should pay attention to columns with NaNs and the number of NaNs for each row can serve as a nice feature later.</p>
<div class="cell" data-scrolled="true" data-execution_count="13">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of NaNs for each object</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>train.isnull().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>0     25
1     19
2     24
3     24
4     24
5     24
6     24
7     24
8     16
9     24
10    22
11    24
12    17
13    24
14    24
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="14">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of NaNs for each column</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>train.isnull().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>).head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>ID           0
VAR_0001     0
VAR_0002     0
VAR_0003     0
VAR_0004     0
VAR_0005     0
VAR_0006    56
VAR_0007    56
VAR_0008    56
VAR_0009    56
VAR_0010    56
VAR_0011    56
VAR_0012    56
VAR_0013    56
VAR_0014    56
dtype: int64</code></pre>
</div>
</div>
<p>Just by reviewing the head of the lists we immediately see the patterns, exactly 56 NaNs for a set of variables, and 24 NaNs for objects.</p>
</section>
<section id="dataset-cleaning" class="level1">
<h1>Dataset cleaning</h1>
<section id="remove-constant-features" class="level3">
<h3 class="anchored" data-anchor-id="remove-constant-features">Remove constant features</h3>
<p>All 1932 columns are anonimized which makes us to deduce the meaning of the features ourselves. We will now try to clean the dataset.</p>
<p>It is usually convenient to concatenate train and test into one dataframe and do all feature engineering using it.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>traintest <span class="op">=</span> pd.concat([train, test], axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First we schould look for a constant features, such features do not provide any information and only make our dataset larger.</p>
<div class="cell" data-scrolled="true" data-execution_count="16">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `dropna = False` makes nunique treat NaNs as a distinct value</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>feats_counts <span class="op">=</span> train.nunique(dropna <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="17">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>feats_counts.sort_values()[:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>VAR_0213    1
VAR_0207    1
VAR_0840    1
VAR_0847    1
VAR_1428    1
VAR_1165    2
VAR_0438    2
VAR_1164    2
VAR_1163    2
VAR_1162    2
dtype: int64</code></pre>
</div>
</div>
<p>We found 5 constant features. Let’s remove them.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>constant_features <span class="op">=</span> feats_counts.loc[feats_counts<span class="op">==</span><span class="dv">1</span>].index.tolist()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (constant_features)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>traintest.drop(constant_features,axis <span class="op">=</span> <span class="dv">1</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['VAR_0207', 'VAR_0213', 'VAR_0840', 'VAR_0847', 'VAR_1428']</code></pre>
</div>
</div>
</section>
<section id="remove-duplicated-features" class="level3">
<h3 class="anchored" data-anchor-id="remove-duplicated-features">Remove duplicated features</h3>
<p>Fill NaNs with something we can find later if needed.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>traintest.fillna(<span class="st">'NaN'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s encode each feature, as we discussed.</p>
<div class="cell" data-scrolled="true" data-execution_count="32">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>train_enc <span class="op">=</span>  pd.DataFrame(index <span class="op">=</span> train.index)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> tqdm_notebook(traintest.columns):</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    train_enc[col] <span class="op">=</span> train[col].factorize()[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"69a26cbd5f2940f7a716bcae46dcae33","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
</div>
<p>We could also do something like this:</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># train_enc[col] = train[col].map(train[col].value_counts())</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting data frame is very very large, so we cannot just transpose it and use .duplicated. That is why we will use a simple loop.</p>
<div class="cell" data-scrolled="true" data-execution_count="34">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dup_cols <span class="op">=</span> {}</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, c1 <span class="kw">in</span> <span class="bu">enumerate</span>(tqdm_notebook(train_enc.columns)):</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c2 <span class="kw">in</span> train_enc.columns[i <span class="op">+</span> <span class="dv">1</span>:]:</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> c2 <span class="kw">not</span> <span class="kw">in</span> dup_cols <span class="kw">and</span> np.<span class="bu">all</span>(train_enc[c1] <span class="op">==</span> train_enc[c2]):</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>            dup_cols[c2] <span class="op">=</span> c1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d327617ea1954a13b87e2d2ee183a512","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="36">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dup_cols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>{'VAR_0009': 'VAR_0008',
 'VAR_0010': 'VAR_0008',
 'VAR_0011': 'VAR_0008',
 'VAR_0012': 'VAR_0008',
 'VAR_0013': 'VAR_0006',
 'VAR_0018': 'VAR_0008',
 'VAR_0019': 'VAR_0008',
 'VAR_0020': 'VAR_0008',
 'VAR_0021': 'VAR_0008',
 'VAR_0022': 'VAR_0008',
 'VAR_0023': 'VAR_0008',
 'VAR_0024': 'VAR_0008',
 'VAR_0025': 'VAR_0008',
 'VAR_0026': 'VAR_0008',
 'VAR_0027': 'VAR_0008',
 'VAR_0028': 'VAR_0008',
 'VAR_0029': 'VAR_0008',
 'VAR_0030': 'VAR_0008',
 'VAR_0031': 'VAR_0008',
 'VAR_0032': 'VAR_0008',
 'VAR_0038': 'VAR_0008',
 'VAR_0039': 'VAR_0008',
 'VAR_0040': 'VAR_0008',
 'VAR_0041': 'VAR_0008',
 'VAR_0042': 'VAR_0008',
 'VAR_0043': 'VAR_0008',
 'VAR_0044': 'VAR_0008',
 'VAR_0181': 'VAR_0180',
 'VAR_0182': 'VAR_0180',
 'VAR_0189': 'VAR_0188',
 'VAR_0190': 'VAR_0188',
 'VAR_0196': 'VAR_0008',
 'VAR_0197': 'VAR_0008',
 'VAR_0199': 'VAR_0008',
 'VAR_0201': 'VAR_0051',
 'VAR_0202': 'VAR_0008',
 'VAR_0203': 'VAR_0008',
 'VAR_0210': 'VAR_0208',
 'VAR_0211': 'VAR_0208',
 'VAR_0215': 'VAR_0008',
 'VAR_0216': 'VAR_0008',
 'VAR_0221': 'VAR_0008',
 'VAR_0222': 'VAR_0008',
 'VAR_0223': 'VAR_0008',
 'VAR_0228': 'VAR_0227',
 'VAR_0229': 'VAR_0008',
 'VAR_0238': 'VAR_0089',
 'VAR_0239': 'VAR_0008',
 'VAR_0357': 'VAR_0260',
 'VAR_0394': 'VAR_0246',
 'VAR_0438': 'VAR_0246',
 'VAR_0446': 'VAR_0246',
 'VAR_0512': 'VAR_0506',
 'VAR_0527': 'VAR_0246',
 'VAR_0528': 'VAR_0246',
 'VAR_0529': 'VAR_0526',
 'VAR_0530': 'VAR_0246',
 'VAR_0672': 'VAR_0670',
 'VAR_1036': 'VAR_0916'}</code></pre>
</div>
</div>
<p>Don’t forget to save them, as it takes long time to find these.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cPickle <span class="im">as</span> pickle</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>pickle.dump(dup_cols, <span class="bu">open</span>(<span class="st">'dup_cols.p'</span>, <span class="st">'w'</span>), protocol<span class="op">=</span>pickle.HIGHEST_PROTOCOL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Drop from traintest.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>traintest.drop(dup_cols.keys(), axis <span class="op">=</span> <span class="dv">1</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="determine-types" class="level1">
<h1>Determine types</h1>
<p>Let’s examine the number of unique values.</p>
<div class="cell" data-scrolled="true" data-execution_count="50">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>nunique <span class="op">=</span> train.nunique(dropna<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>nunique</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>ID                145231
VAR_0001               3
VAR_0002             820
VAR_0003             588
VAR_0004            7935
VAR_0005               4
VAR_0006              38
VAR_0007              36
VAR_0008               2
VAR_0009               2
VAR_0010               2
VAR_0011               2
VAR_0012               2
VAR_0013              38
VAR_0014              38
VAR_0015              27
VAR_0016              30
VAR_0017              26
VAR_0018               2
VAR_0019               2
VAR_0020               2
VAR_0021               2
VAR_0022               2
VAR_0023               2
VAR_0024               2
VAR_0025               2
VAR_0026               2
VAR_0027               2
VAR_0028               2
VAR_0029               2
                   ...  
VAR_1907              41
VAR_1908              37
VAR_1909              41
VAR_1910              37
VAR_1911             107
VAR_1912           16370
VAR_1913           25426
VAR_1914           14226
VAR_1915            1148
VAR_1916               8
VAR_1917              10
VAR_1918              86
VAR_1919             383
VAR_1920              22
VAR_1921              18
VAR_1922            6798
VAR_1923            2445
VAR_1924             573
VAR_1925              11
VAR_1926               6
VAR_1927              10
VAR_1928              30
VAR_1929             591
VAR_1930               8
VAR_1931              10
VAR_1932              74
VAR_1933             363
VAR_1934               5
target                 2
VAR_0004_mod50        50
Length: 1935, dtype: int64</code></pre>
</div>
</div>
<p>and build a histogram of those values</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">6</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> plt.hist(nunique.astype(<span class="bu">float</span>)<span class="op">/</span>train.shape[<span class="dv">0</span>], bins<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="EDA_Springleaf_screencast_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Let’s take a looks at the features with a huge number of unique values:</p>
<div class="cell" data-scrolled="true" data-execution_count="61">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> (nunique.astype(<span class="bu">float</span>)<span class="op">/</span>train.shape[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="fl">0.8</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>train.loc[:, mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>VAR_0212</th>
      <th>VAR_0227</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>NaN</td>
      <td>311951</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>9.20713e+10</td>
      <td>2.76949e+06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>2.65477e+10</td>
      <td>654127</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>7.75753e+10</td>
      <td>3.01509e+06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>6.04238e+10</td>
      <td>118678</td>
    </tr>
    <tr>
      <th>5</th>
      <td>14</td>
      <td>7.73796e+10</td>
      <td>1.76557e+06</td>
    </tr>
    <tr>
      <th>6</th>
      <td>16</td>
      <td>9.70303e+10</td>
      <td>80151</td>
    </tr>
    <tr>
      <th>7</th>
      <td>20</td>
      <td>3.10981e+10</td>
      <td>853641</td>
    </tr>
    <tr>
      <th>8</th>
      <td>21</td>
      <td>7.82124e+10</td>
      <td>1.40254e+06</td>
    </tr>
    <tr>
      <th>9</th>
      <td>22</td>
      <td>1.94014e+10</td>
      <td>2.2187e+06</td>
    </tr>
    <tr>
      <th>10</th>
      <td>23</td>
      <td>3.71295e+10</td>
      <td>2.77679e+06</td>
    </tr>
    <tr>
      <th>11</th>
      <td>24</td>
      <td>3.01203e+10</td>
      <td>434300</td>
    </tr>
    <tr>
      <th>12</th>
      <td>25</td>
      <td>1.80185e+10</td>
      <td>1.48914e+06</td>
    </tr>
    <tr>
      <th>13</th>
      <td>26</td>
      <td>9.83358e+10</td>
      <td>686666</td>
    </tr>
    <tr>
      <th>14</th>
      <td>28</td>
      <td>9.33087e+10</td>
      <td>1.4847e+06</td>
    </tr>
    <tr>
      <th>15</th>
      <td>30</td>
      <td>2.01715e+10</td>
      <td>883714</td>
    </tr>
    <tr>
      <th>16</th>
      <td>31</td>
      <td>4.15638e+10</td>
      <td>2.6707e+06</td>
    </tr>
    <tr>
      <th>17</th>
      <td>32</td>
      <td>9.17617e+10</td>
      <td>2.65485e+06</td>
    </tr>
    <tr>
      <th>18</th>
      <td>35</td>
      <td>3.81344e+10</td>
      <td>487721</td>
    </tr>
    <tr>
      <th>19</th>
      <td>36</td>
      <td>NaN</td>
      <td>2.54705e+06</td>
    </tr>
    <tr>
      <th>20</th>
      <td>37</td>
      <td>3.27144e+10</td>
      <td>1.74684e+06</td>
    </tr>
    <tr>
      <th>21</th>
      <td>38</td>
      <td>1.82142e+10</td>
      <td>2.5813e+06</td>
    </tr>
    <tr>
      <th>22</th>
      <td>40</td>
      <td>7.70153e+10</td>
      <td>2.59396e+06</td>
    </tr>
    <tr>
      <th>23</th>
      <td>42</td>
      <td>4.69701e+10</td>
      <td>1.02977e+06</td>
    </tr>
    <tr>
      <th>24</th>
      <td>43</td>
      <td>9.84442e+10</td>
      <td>1.45101e+06</td>
    </tr>
    <tr>
      <th>25</th>
      <td>46</td>
      <td>NaN</td>
      <td>2.37136e+06</td>
    </tr>
    <tr>
      <th>26</th>
      <td>50</td>
      <td>9.25094e+10</td>
      <td>665930</td>
    </tr>
    <tr>
      <th>27</th>
      <td>51</td>
      <td>3.09094e+10</td>
      <td>497686</td>
    </tr>
    <tr>
      <th>28</th>
      <td>52</td>
      <td>6.06105e+10</td>
      <td>1.95816e+06</td>
    </tr>
    <tr>
      <th>29</th>
      <td>54</td>
      <td>3.78768e+10</td>
      <td>1.62591e+06</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>145201</th>
      <td>290409</td>
      <td>8.80126e+10</td>
      <td>1.83053e+06</td>
    </tr>
    <tr>
      <th>145202</th>
      <td>290412</td>
      <td>4.6152e+10</td>
      <td>1.02024e+06</td>
    </tr>
    <tr>
      <th>145203</th>
      <td>290414</td>
      <td>9.33055e+10</td>
      <td>1.88151e+06</td>
    </tr>
    <tr>
      <th>145204</th>
      <td>290415</td>
      <td>4.63509e+10</td>
      <td>669351</td>
    </tr>
    <tr>
      <th>145205</th>
      <td>290417</td>
      <td>2.36028e+10</td>
      <td>655797</td>
    </tr>
    <tr>
      <th>145206</th>
      <td>290424</td>
      <td>3.73293e+10</td>
      <td>1.45626e+06</td>
    </tr>
    <tr>
      <th>145207</th>
      <td>290426</td>
      <td>2.38892e+10</td>
      <td>1.9503e+06</td>
    </tr>
    <tr>
      <th>145208</th>
      <td>290427</td>
      <td>6.38632e+10</td>
      <td>596365</td>
    </tr>
    <tr>
      <th>145209</th>
      <td>290429</td>
      <td>3.00602e+10</td>
      <td>572119</td>
    </tr>
    <tr>
      <th>145210</th>
      <td>290431</td>
      <td>4.33429e+10</td>
      <td>16120</td>
    </tr>
    <tr>
      <th>145211</th>
      <td>290432</td>
      <td>3.86543e+10</td>
      <td>2.08375e+06</td>
    </tr>
    <tr>
      <th>145212</th>
      <td>290434</td>
      <td>9.21391e+10</td>
      <td>1.89779e+06</td>
    </tr>
    <tr>
      <th>145213</th>
      <td>290436</td>
      <td>3.07472e+10</td>
      <td>2.94532e+06</td>
    </tr>
    <tr>
      <th>145214</th>
      <td>290439</td>
      <td>7.83326e+10</td>
      <td>2.54726e+06</td>
    </tr>
    <tr>
      <th>145215</th>
      <td>290440</td>
      <td>NaN</td>
      <td>600318</td>
    </tr>
    <tr>
      <th>145216</th>
      <td>290441</td>
      <td>2.78561e+10</td>
      <td>602505</td>
    </tr>
    <tr>
      <th>145217</th>
      <td>290443</td>
      <td>1.90952e+10</td>
      <td>2.44184e+06</td>
    </tr>
    <tr>
      <th>145218</th>
      <td>290445</td>
      <td>4.62035e+10</td>
      <td>2.87349e+06</td>
    </tr>
    <tr>
      <th>145219</th>
      <td>290447</td>
      <td>NaN</td>
      <td>1.53493e+06</td>
    </tr>
    <tr>
      <th>145220</th>
      <td>290448</td>
      <td>7.54282e+10</td>
      <td>1.60102e+06</td>
    </tr>
    <tr>
      <th>145221</th>
      <td>290449</td>
      <td>4.30768e+10</td>
      <td>2.08415e+06</td>
    </tr>
    <tr>
      <th>145222</th>
      <td>290450</td>
      <td>7.81325e+10</td>
      <td>2.85367e+06</td>
    </tr>
    <tr>
      <th>145223</th>
      <td>290452</td>
      <td>4.51061e+10</td>
      <td>1.56506e+06</td>
    </tr>
    <tr>
      <th>145224</th>
      <td>290453</td>
      <td>4.62223e+10</td>
      <td>1.46815e+06</td>
    </tr>
    <tr>
      <th>145225</th>
      <td>290454</td>
      <td>7.74507e+10</td>
      <td>2.92811e+06</td>
    </tr>
    <tr>
      <th>145226</th>
      <td>290457</td>
      <td>7.05088e+10</td>
      <td>2.03657e+06</td>
    </tr>
    <tr>
      <th>145227</th>
      <td>290458</td>
      <td>9.02492e+10</td>
      <td>1.68013e+06</td>
    </tr>
    <tr>
      <th>145228</th>
      <td>290459</td>
      <td>9.17224e+10</td>
      <td>2.41922e+06</td>
    </tr>
    <tr>
      <th>145229</th>
      <td>290461</td>
      <td>4.51033e+10</td>
      <td>1.53960e+06</td>
    </tr>
    <tr>
      <th>145230</th>
      <td>290463</td>
      <td>9.14114e+10</td>
      <td>2.6609e+06</td>
    </tr>
  </tbody>
</table>
<p>145231 rows × 3 columns</p>
</div>
</div>
</div>
<p>The values are not float, they are integer, so these features are likely to be even counts. Let’s look at another pack of features.</p>
<div class="cell" data-scrolled="true" data-execution_count="64">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> (nunique.astype(<span class="bu">float</span>)<span class="op">/</span>train.shape[<span class="dv">0</span>] <span class="op">&lt;</span> <span class="fl">0.8</span>) <span class="op">&amp;</span> (nunique.astype(<span class="bu">float</span>)<span class="op">/</span>train.shape[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="fl">0.4</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>train.loc[:<span class="dv">25</span>, mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>VAR_0541</th>
      <th>VAR_0543</th>
      <th>VAR_0899</th>
      <th>VAR_1081</th>
      <th>VAR_1082</th>
      <th>VAR_1087</th>
      <th>VAR_1179</th>
      <th>VAR_1180</th>
      <th>VAR_1181</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49463</td>
      <td>116783</td>
      <td>112871</td>
      <td>76857</td>
      <td>76857</td>
      <td>116783</td>
      <td>76857</td>
      <td>76857</td>
      <td>76857</td>
    </tr>
    <tr>
      <th>1</th>
      <td>303472</td>
      <td>346196</td>
      <td>346375</td>
      <td>341365</td>
      <td>341365</td>
      <td>346196</td>
      <td>341365</td>
      <td>341365</td>
      <td>176604</td>
    </tr>
    <tr>
      <th>2</th>
      <td>94990</td>
      <td>122601</td>
      <td>121501</td>
      <td>107267</td>
      <td>107267</td>
      <td>121501</td>
      <td>107267</td>
      <td>107267</td>
      <td>58714</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20593</td>
      <td>59490</td>
      <td>61890</td>
      <td>45794</td>
      <td>47568</td>
      <td>59490</td>
      <td>45794</td>
      <td>47568</td>
      <td>47568</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10071</td>
      <td>35708</td>
      <td>34787</td>
      <td>20475</td>
      <td>23647</td>
      <td>34708</td>
      <td>20475</td>
      <td>23647</td>
      <td>23647</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18877</td>
      <td>28055</td>
      <td>28455</td>
      <td>21139</td>
      <td>21139</td>
      <td>28055</td>
      <td>21139</td>
      <td>21139</td>
      <td>20627</td>
    </tr>
    <tr>
      <th>6</th>
      <td>321783</td>
      <td>333565</td>
      <td>886886</td>
      <td>327744</td>
      <td>327744</td>
      <td>333565</td>
      <td>327744</td>
      <td>327744</td>
      <td>163944</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2961</td>
      <td>5181</td>
      <td>11084</td>
      <td>4326</td>
      <td>4326</td>
      <td>5181</td>
      <td>4326</td>
      <td>4326</td>
      <td>4326</td>
    </tr>
    <tr>
      <th>8</th>
      <td>20359</td>
      <td>30114</td>
      <td>33434</td>
      <td>24969</td>
      <td>27128</td>
      <td>30114</td>
      <td>24969</td>
      <td>27128</td>
      <td>27128</td>
    </tr>
    <tr>
      <th>9</th>
      <td>815</td>
      <td>1300</td>
      <td>7677</td>
      <td>1197</td>
      <td>1197</td>
      <td>1300</td>
      <td>1197</td>
      <td>1197</td>
      <td>1197</td>
    </tr>
    <tr>
      <th>10</th>
      <td>6088</td>
      <td>15233</td>
      <td>15483</td>
      <td>7077</td>
      <td>7077</td>
      <td>15233</td>
      <td>7077</td>
      <td>7077</td>
      <td>4033</td>
    </tr>
    <tr>
      <th>11</th>
      <td>432</td>
      <td>1457</td>
      <td>2000</td>
      <td>621</td>
      <td>621</td>
      <td>757</td>
      <td>621</td>
      <td>621</td>
      <td>621</td>
    </tr>
    <tr>
      <th>12</th>
      <td>383</td>
      <td>539</td>
      <td>860</td>
      <td>752</td>
      <td>1158</td>
      <td>539</td>
      <td>752</td>
      <td>1158</td>
      <td>1158</td>
    </tr>
    <tr>
      <th>13</th>
      <td>14359</td>
      <td>47562</td>
      <td>47562</td>
      <td>17706</td>
      <td>17706</td>
      <td>47562</td>
      <td>17706</td>
      <td>17706</td>
      <td>17706</td>
    </tr>
    <tr>
      <th>14</th>
      <td>145391</td>
      <td>218067</td>
      <td>214836</td>
      <td>176627</td>
      <td>176627</td>
      <td>216307</td>
      <td>175273</td>
      <td>175273</td>
      <td>91019</td>
    </tr>
    <tr>
      <th>15</th>
      <td>10040</td>
      <td>12119</td>
      <td>17263</td>
      <td>10399</td>
      <td>10399</td>
      <td>12119</td>
      <td>10399</td>
      <td>10399</td>
      <td>5379</td>
    </tr>
    <tr>
      <th>16</th>
      <td>4880</td>
      <td>9607</td>
      <td>9607</td>
      <td>9165</td>
      <td>9165</td>
      <td>9607</td>
      <td>9165</td>
      <td>9165</td>
      <td>9165</td>
    </tr>
    <tr>
      <th>17</th>
      <td>12900</td>
      <td>35590</td>
      <td>35781</td>
      <td>26096</td>
      <td>26096</td>
      <td>35590</td>
      <td>26096</td>
      <td>26096</td>
      <td>19646</td>
    </tr>
    <tr>
      <th>18</th>
      <td>104442</td>
      <td>139605</td>
      <td>150505</td>
      <td>136419</td>
      <td>142218</td>
      <td>139605</td>
      <td>136419</td>
      <td>142218</td>
      <td>142218</td>
    </tr>
    <tr>
      <th>19</th>
      <td>13898</td>
      <td>25566</td>
      <td>26685</td>
      <td>20122</td>
      <td>20122</td>
      <td>25566</td>
      <td>20122</td>
      <td>20122</td>
      <td>20122</td>
    </tr>
    <tr>
      <th>20</th>
      <td>3524</td>
      <td>10033</td>
      <td>10133</td>
      <td>5838</td>
      <td>5838</td>
      <td>10033</td>
      <td>5838</td>
      <td>5838</td>
      <td>5838</td>
    </tr>
    <tr>
      <th>21</th>
      <td>129873</td>
      <td>204072</td>
      <td>206946</td>
      <td>183049</td>
      <td>183049</td>
      <td>204072</td>
      <td>183049</td>
      <td>183049</td>
      <td>96736</td>
    </tr>
    <tr>
      <th>22</th>
      <td>3591</td>
      <td>11400</td>
      <td>17680</td>
      <td>5565</td>
      <td>5565</td>
      <td>11400</td>
      <td>5565</td>
      <td>5565</td>
      <td>5565</td>
    </tr>
    <tr>
      <th>23</th>
      <td>999999999</td>
      <td>999999999</td>
      <td>-99999</td>
      <td>999999999</td>
      <td>999999999</td>
      <td>999999999</td>
      <td>999999999</td>
      <td>999999999</td>
      <td>999999999</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1270</td>
      <td>4955</td>
      <td>12201</td>
      <td>2490</td>
      <td>2490</td>
      <td>4955</td>
      <td>2490</td>
      <td>2490</td>
      <td>2490</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2015</td>
      <td>2458</td>
      <td>2458</td>
      <td>2015</td>
      <td>2015</td>
      <td>2458</td>
      <td>2015</td>
      <td>2015</td>
      <td>1008</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>These look like counts too. First thing to notice is the 23th line: 99999.., -99999 values look like NaNs so we should probably built a related feature. Second: the columns are sometimes placed next to each other, so the columns are probably grouped together and we can disentangle that.</p>
<p>Our conclusion: there are no floating point variables, there are some counts variables, which we will treat as numeric.</p>
<p>And finally, let’s pick one variable (in this case ‘VAR_0015’) from the third group of features.</p>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>train[<span class="st">'VAR_0015'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code> 0.0      102382
 1.0       28045
 2.0        8981
 3.0        3199
 4.0        1274
 5.0         588
 6.0         275
 7.0         166
 8.0          97
-999.0        56
 9.0          51
 10.0         39
 11.0         18
 12.0         16
 13.0          9
 14.0          8
 15.0          8
 16.0          6
 22.0          3
 21.0          3
 19.0          1
 35.0          1
 17.0          1
 29.0          1
 18.0          1
 32.0          1
 23.0          1
Name: VAR_0015, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="op">=</span> <span class="bu">list</span>(train.select_dtypes(include<span class="op">=</span>[<span class="st">'object'</span>]).columns)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>num_cols <span class="op">=</span> <span class="bu">list</span>(train.select_dtypes(exclude<span class="op">=</span>[<span class="st">'object'</span>]).columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="go-through" class="level1">
<h1>Go through</h1>
<p>Let’s replace NaNs with something first.</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>train.replace(<span class="st">'NaN'</span>, <span class="op">-</span><span class="dv">999</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s calculate how many times one feature is greater than the other and create cross tabel out of it.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select first 42 numeric features</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>feats <span class="op">=</span> num_cols[:<span class="dv">42</span>]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># build 'mean(feat1 &gt; feat2)' plot</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>gt_matrix(feats,<span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="EDA_Springleaf_screencast_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Indeed, we see interesting patterns here. There are blocks of geatures where one is strictly greater than the other. So we can hypothesize, that each column correspondes to cumulative counts, e.g.&nbsp;feature number one is counts in first month, second – total count number in first two month and so on. So we immediately understand what features we should generate to make tree-based models more efficient: the differences between consecutive values.</p>
<section id="var_0002-var_0003" class="level2">
<h2 class="anchored" data-anchor-id="var_0002-var_0003">VAR_0002, VAR_0003</h2>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>hist_it(train[<span class="st">'VAR_0002'</span>])</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>,<span class="fl">0.05</span>))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>plt.xlim((<span class="op">-</span><span class="dv">10</span>,<span class="dv">1010</span>))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>hist_it(train[<span class="st">'VAR_0003'</span>])</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>,<span class="fl">0.03</span>))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>plt.xlim((<span class="op">-</span><span class="dv">10</span>,<span class="dv">1010</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>(-10, 1010)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="EDA_Springleaf_screencast_files/figure-html/cell-31-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="EDA_Springleaf_screencast_files/figure-html/cell-31-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="39">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>train[<span class="st">'VAR_0002'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>12     5264
24     4763
36     3499
60     2899
6      2657
13     2478
72     2243
48     2222
3      2171
4      1917
2      1835
84     1801
120    1786
1      1724
7      1671
26     1637
5      1624
14     1572
18     1555
8      1513
999    1510
25     1504
96     1445
30     1438
9      1306
144    1283
15     1221
27     1186
38     1146
37     1078
       ... 
877       1
785       1
750       1
653       1
784       1
764       1
751       1
797       1
926       1
691       1
808       1
774       1
902       1
755       1
656       1
814       1
813       1
685       1
739       1
935       1
906       1
807       1
550       1
933       1
804       1
675       1
674       1
745       1
778       1
851       1
Name: VAR_0002, Length: 820, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="38">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>train[<span class="st">'VAR_0003'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>0      17436
24      3469
12      3271
60      3054
36      2498
72      2081
48      2048
6       1993
1       1797
3       1679
84      1553
2       1459
999     1428
4       1419
120     1411
7       1356
13      1297
18      1296
96      1253
14      1228
8       1216
5       1189
9       1182
30      1100
25      1100
144     1090
15      1047
61      1008
26       929
42       921
       ...  
560        1
552        1
550        1
804        1
543        1
668        1
794        1
537        1
531        1
664        1
632        1
709        1
597        1
965        1
852        1
648        1
596        1
466        1
592        1
521        1
533        1
636        1
975        1
973        1
587        1
523        1
584        1
759        1
583        1
570        1
Name: VAR_0003, Length: 588, dtype: int64</code></pre>
</div>
</div>
<p>We see there is something special about 12, 24 and so on, sowe can create another feature x mod 12.</p>
</section>
<section id="var_0004" class="level2">
<h2 class="anchored" data-anchor-id="var_0004">VAR_0004</h2>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>train[<span class="st">'VAR_0004_mod50'</span>] <span class="op">=</span> train[<span class="st">'VAR_0004'</span>] <span class="op">%</span> <span class="dv">50</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>hist_it(train[<span class="st">'VAR_0004_mod50'</span>])</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>,<span class="fl">0.6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>(0, 0.6)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="EDA_Springleaf_screencast_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="categorical-features" class="level1">
<h1>Categorical features</h1>
<p>Let’s take a look at categorical features we have.</p>
<div class="cell" data-scrolled="true" data-execution_count="57">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>train.loc[:,cat_cols].head().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>VAR_0001</th>
      <td>H</td>
      <td>H</td>
      <td>H</td>
      <td>H</td>
      <td>R</td>
    </tr>
    <tr>
      <th>VAR_0005</th>
      <td>C</td>
      <td>B</td>
      <td>C</td>
      <td>C</td>
      <td>N</td>
    </tr>
    <tr>
      <th>VAR_0008</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0009</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0010</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0011</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0012</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0043</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0044</th>
      <td>[]</td>
      <td>[]</td>
      <td>[]</td>
      <td>[]</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>VAR_0073</th>
      <td>NaT</td>
      <td>2012-09-04 00:00:00</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0075</th>
      <td>2011-11-08 00:00:00</td>
      <td>2011-11-10 00:00:00</td>
      <td>2011-12-13 00:00:00</td>
      <td>2010-09-23 00:00:00</td>
      <td>2011-10-15 00:00:00</td>
    </tr>
    <tr>
      <th>VAR_0156</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0157</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0158</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0159</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0166</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0167</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0168</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0169</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0176</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0177</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0178</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0179</th>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>VAR_0196</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0200</th>
      <td>FT LAUDERDALE</td>
      <td>SANTEE</td>
      <td>REEDSVILLE</td>
      <td>LIBERTY</td>
      <td>FRANKFORT</td>
    </tr>
    <tr>
      <th>VAR_0202</th>
      <td>BatchInquiry</td>
      <td>BatchInquiry</td>
      <td>BatchInquiry</td>
      <td>BatchInquiry</td>
      <td>BatchInquiry</td>
    </tr>
    <tr>
      <th>VAR_0204</th>
      <td>2014-01-29 21:16:00</td>
      <td>2014-02-01 00:11:00</td>
      <td>2014-01-30 15:11:00</td>
      <td>2014-02-01 00:07:00</td>
      <td>2014-01-29 19:31:00</td>
    </tr>
    <tr>
      <th>VAR_0214</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>VAR_0216</th>
      <td>DS</td>
      <td>DS</td>
      <td>DS</td>
      <td>DS</td>
      <td>DS</td>
    </tr>
    <tr>
      <th>VAR_0217</th>
      <td>2011-11-08 02:00:00</td>
      <td>2012-10-02 02:00:00</td>
      <td>2011-12-13 02:00:00</td>
      <td>2012-11-01 02:00:00</td>
      <td>2011-10-15 02:00:00</td>
    </tr>
    <tr>
      <th>VAR_0222</th>
      <td>C6</td>
      <td>C6</td>
      <td>C6</td>
      <td>C6</td>
      <td>C6</td>
    </tr>
    <tr>
      <th>VAR_0226</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0229</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0230</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0232</th>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>VAR_0236</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>VAR_0237</th>
      <td>FL</td>
      <td>CA</td>
      <td>WV</td>
      <td>TX</td>
      <td>IL</td>
    </tr>
    <tr>
      <th>VAR_0239</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>VAR_0274</th>
      <td>FL</td>
      <td>MI</td>
      <td>WV</td>
      <td>TX</td>
      <td>IL</td>
    </tr>
    <tr>
      <th>VAR_0283</th>
      <td>S</td>
      <td>S</td>
      <td>S</td>
      <td>S</td>
      <td>S</td>
    </tr>
    <tr>
      <th>VAR_0305</th>
      <td>S</td>
      <td>S</td>
      <td>P</td>
      <td>P</td>
      <td>P</td>
    </tr>
    <tr>
      <th>VAR_0325</th>
      <td>-1</td>
      <td>H</td>
      <td>R</td>
      <td>H</td>
      <td>S</td>
    </tr>
    <tr>
      <th>VAR_0342</th>
      <td>CF</td>
      <td>EC</td>
      <td>UU</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>VAR_0352</th>
      <td>O</td>
      <td>O</td>
      <td>R</td>
      <td>R</td>
      <td>R</td>
    </tr>
    <tr>
      <th>VAR_0353</th>
      <td>U</td>
      <td>R</td>
      <td>R</td>
      <td>R</td>
      <td>U</td>
    </tr>
    <tr>
      <th>VAR_0354</th>
      <td>O</td>
      <td>R</td>
      <td>-1</td>
      <td>-1</td>
      <td>O</td>
    </tr>
    <tr>
      <th>VAR_0404</th>
      <td>CHIEF EXECUTIVE OFFICER</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>VAR_0466</th>
      <td>-1</td>
      <td>I</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>VAR_0467</th>
      <td>-1</td>
      <td>Discharged</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>VAR_0493</th>
      <td>COMMUNITY ASSOCIATION MANAGER</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>VAR_1934</th>
      <td>IAPS</td>
      <td>IAPS</td>
      <td>IAPS</td>
      <td>RCC</td>
      <td>BRANCH</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><code>VAR_0200</code>, <code>VAR_0237</code>, <code>VAR_0274</code> look like some georgraphical data thus one could generate geography related features, we will talk later in the course.</p>
<p>There are some features, that are hard to identify, but look, there a date columns <code>VAR_0073</code> – <code>VAR_0179</code>, <code>VAR_0204</code>, <code>VAR_0217</code>. It is useful to plot one date against another to find relationships.</p>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>date_cols <span class="op">=</span> [<span class="st">u'VAR_0073'</span>,<span class="st">'VAR_0075'</span>,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>             <span class="st">u'VAR_0156'</span>,<span class="st">u'VAR_0157'</span>,<span class="st">u'VAR_0158'</span>,<span class="st">'VAR_0159'</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">u'VAR_0166'</span>, <span class="st">u'VAR_0167'</span>,<span class="st">u'VAR_0168'</span>,<span class="st">u'VAR_0169'</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">u'VAR_0176'</span>,<span class="st">u'VAR_0177'</span>,<span class="st">u'VAR_0178'</span>,<span class="st">u'VAR_0179'</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">u'VAR_0204'</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">u'VAR_0217'</span>]</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> date_cols:</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    train[c] <span class="op">=</span> pd.to_datetime(train[c],<span class="bu">format</span> <span class="op">=</span> <span class="st">'</span><span class="sc">%d</span><span class="st">%b%y:%H:%M:%S'</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    test[c] <span class="op">=</span> pd.to_datetime(test[c],  <span class="bu">format</span> <span class="op">=</span> <span class="st">'</span><span class="sc">%d</span><span class="st">%b%y:%H:%M:%S'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="op">=</span> <span class="st">'VAR_0217'</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>c2 <span class="op">=</span> <span class="st">'VAR_0073'</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mask = (~test[c1].isnull()) &amp; (~test[c2].isnull())</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sc2(test.ix[mask,c1].values,test.ix[mask,c2].values,alpha=0.7,c = 'black')</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> (<span class="op">~</span>train[c1].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>train[c2].isnull())</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>sc2(train.loc[mask,c1].values,train.loc[mask,c2].values,c<span class="op">=</span>train.loc[mask,<span class="st">'target'</span>].values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="EDA_Springleaf_screencast_files/figure-html/cell-37-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>We see that one date is strictly greater than the other, so the difference between them can be a good feature. Also look at horizontal line there – it also looks like NaN, so I would rather create a new binary feature which will serve as an idicator that our time feature is NaN.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kcsgoodboy/en" data-repo-id="R_kgDOIixJIQ" data-category="General" data-category-id="DIC_kwDOIixJIc4CTiz-" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2023, Chanseok Kang</div>
  </div>
</footer>



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>